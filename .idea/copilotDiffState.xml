<?xml version="1.0" encoding="UTF-8"?>
<project version="4">
  <component name="CopilotDiffPersistence">
    <option name="pendingDiffs">
      <map>
        <entry key="$PROJECT_DIR$/app/build.gradle.kts">
          <value>
            <PendingDiffInfo>
              <option name="filePath" value="$PROJECT_DIR$/app/build.gradle.kts" />
              <option name="updatedContent" value="plugins {&#10;    alias(libs.plugins.android.application)&#10;    alias(libs.plugins.kotlin.android)&#10;}&#10;&#10;android {&#10;    namespace = &quot;com.lavazza.ciclocafe&quot;&#10;    compileSdk = 36&#10;&#10;    defaultConfig {&#10;        applicationId = &quot;com.lavazza.ciclocafe&quot;&#10;        minSdk = 24&#10;        targetSdk = 36&#10;        versionCode = 1&#10;        versionName = &quot;1.0&quot;&#10;&#10;        testInstrumentationRunner = &quot;androidx.test.runner.AndroidJUnitRunner&quot;&#10;    }&#10;&#10;    buildTypes {&#10;        debug {&#10;            isDebuggable = true&#10;        }&#10;        release {&#10;            isMinifyEnabled = false&#10;            proguardFiles(&#10;                getDefaultProguardFile(&quot;proguard-android-optimize.txt&quot;),&#10;                &quot;proguard-rules.pro&quot;&#10;            )&#10;        }&#10;    }&#10;    &#10;    compileOptions {&#10;        sourceCompatibility = JavaVersion.VERSION_11&#10;        targetCompatibility = JavaVersion.VERSION_11&#10;    }&#10;    &#10;    kotlinOptions {&#10;        jvmTarget = &quot;11&quot;&#10;    }&#10;    &#10;    buildFeatures {&#10;        viewBinding = true&#10;    }&#10;}&#10;&#10;dependencies {&#10;&#10;    implementation(libs.androidx.core.ktx)&#10;    implementation(libs.androidx.appcompat)&#10;    implementation(libs.material)&#10;    implementation(libs.androidx.constraintlayout)&#10;    implementation(libs.androidx.lifecycle.livedata.ktx)&#10;    implementation(libs.androidx.lifecycle.viewmodel.ktx)&#10;    implementation(libs.androidx.navigation.fragment.ktx)&#10;    implementation(libs.androidx.navigation.ui.ktx)&#10;&#10;    // Retrofit para llamadas HTTP&#10;    implementation(&quot;com.squareup.retrofit2:retrofit:2.9.0&quot;)&#10;    implementation(&quot;com.squareup.retrofit2:converter-gson:2.9.0&quot;)&#10;&#10;    // OkHttp para logging y networking&#10;    implementation(&quot;com.squareup.okhttp3:okhttp:4.12.0&quot;)&#10;    implementation(&quot;com.squareup.okhttp3:logging-interceptor:4.12.0&quot;)&#10;&#10;    // Gson para serialización JSON&#10;    implementation(&quot;com.google.code.gson:gson:2.10.1&quot;)&#10;&#10;    testImplementation(libs.junit)&#10;    androidTestImplementation(libs.androidx.junit)&#10;    androidTestImplementation(libs.androidx.espresso.core)&#10;}&#10;" />
            </PendingDiffInfo>
          </value>
        </entry>
        <entry key="$PROJECT_DIR$/app/src/main/java/com/lavazza/ciclocafe/ui/entrada/EntradaFragment.kt">
          <value>
            <PendingDiffInfo>
              <option name="filePath" value="$PROJECT_DIR$/app/src/main/java/com/lavazza/ciclocafe/ui/entrada/EntradaFragment.kt" />
              <option name="updatedContent" value="package com.lavazza.ciclocafe.ui.entrada&#10;&#10;import android.content.Intent&#10;import android.os.Bundle&#10;import android.provider.Settings&#10;import android.view.LayoutInflater&#10;import android.view.View&#10;import android.view.ViewGroup&#10;import android.widget.Button&#10;import android.widget.ProgressBar&#10;import android.widget.TextView&#10;import android.widget.Toast&#10;import androidx.fragment.app.Fragment&#10;import androidx.lifecycle.ViewModelProvider&#10;import androidx.lifecycle.lifecycleScope&#10;import androidx.recyclerview.widget.LinearLayoutManager&#10;import androidx.recyclerview.widget.RecyclerView&#10;import com.google.android.material.dialog.MaterialAlertDialogBuilder&#10;import com.lavazza.ciclocafe.R&#10;import com.lavazza.ciclocafe.data.model.Product&#10;import com.lavazza.ciclocafe.data.repository.ProductRepository&#10;import com.lavazza.ciclocafe.ui.reparto.RepartoViewModel&#10;import com.lavazza.ciclocafe.utils.NetworkUtils&#10;import kotlinx.coroutines.launch&#10;&#10;class EntradaFragment : Fragment() {&#10;&#10;    private lateinit var textNumeroReparto: TextView&#10;    private lateinit var recyclerView: RecyclerView&#10;    private lateinit var progressBar: ProgressBar&#10;    private lateinit var btnGuardarEntrada: Button&#10;    private lateinit var fabAddRow: View&#10;&#10;    private lateinit var repartoViewModel: RepartoViewModel&#10;    private val entradaViewModel: EntradaViewModel by lazy { ViewModelProvider(this)[EntradaViewModel::class.java] }&#10;&#10;    private val repository = ProductRepository()&#10;    private var products: List&lt;Product&gt; = emptyList()&#10;    private var adapter: EntradaAdapter? = null&#10;    private val entradaItems = mutableListOf&lt;EntradaItem&gt;()&#10;    private var numeroReparto: String = &quot;&quot;&#10;&#10;    override fun onCreateView(&#10;        inflater: LayoutInflater,&#10;        container: ViewGroup?,&#10;        savedInstanceState: Bundle?&#10;    ): View? {&#10;        val root = inflater.inflate(R.layout.fragment_entrada, container, false)&#10;&#10;        textNumeroReparto = root.findViewById(R.id.textNumeroReparto)&#10;        recyclerView = root.findViewById(R.id.recyclerViewEntrada)&#10;        progressBar = root.findViewById(R.id.progressBar)&#10;        btnGuardarEntrada = root.findViewById(R.id.btnGuardarEntrada)&#10;        fabAddRow = root.findViewById(R.id.fabAddRow)&#10;&#10;        repartoViewModel = ViewModelProvider(requireActivity()).get(RepartoViewModel::class.java)&#10;        repartoViewModel.numeroReparto.observe(viewLifecycleOwner) { reparto -&gt;&#10;            numeroReparto = reparto&#10;            textNumeroReparto.text = getString(R.string.label_reparto, reparto)&#10;        }&#10;&#10;        recyclerView.layoutManager = LinearLayoutManager(requireContext())&#10;        btnGuardarEntrada.setOnClickListener { showConfirmDialog() }&#10;        fabAddRow.setOnClickListener { addBlankRow() }&#10;&#10;        loadProducts()&#10;        return root&#10;    }&#10;&#10;    private fun addBlankRow() {&#10;        entradaItems.add(EntradaItem(producto = &quot;&quot;, selectedProduct = null))&#10;        adapter?.submitList(entradaItems.toList())&#10;    }&#10;&#10;    private fun loadProducts() {&#10;        progressBar.visibility = View.VISIBLE&#10;        lifecycleScope.launch {&#10;            repository.getProducts().fold(&#10;                onSuccess = { productList -&gt;&#10;                    progressBar.visibility = View.GONE&#10;                    products = productList&#10;                    prepareInitialRows()&#10;                },&#10;                onFailure = { error -&gt;&#10;                    progressBar.visibility = View.GONE&#10;                    Toast.makeText(requireContext(), &quot;Error productos: ${error.message}&quot;, Toast.LENGTH_LONG).show()&#10;                    // Fallback mínima&#10;                    products = listOf(&#10;                        Product(&quot;K&quot;, &quot;CAFETERA&quot;, &quot;CAFETERA&quot;),&#10;                        Product(&quot;P&quot;, &quot;PEDIDO&quot;, &quot;Pedido&quot;)&#10;                    )&#10;                    prepareInitialRows()&#10;                }&#10;            )&#10;        }&#10;    }&#10;&#10;    private fun prepareInitialRows() {&#10;        entradaItems.clear()&#10;        // Una fila por producto existente&#10;        products.forEach { p -&gt;&#10;            entradaItems.add(&#10;                EntradaItem(&#10;                    producto = p.name,&#10;                    selectedProduct = p,&#10;                    vueltaLleno = 0,&#10;                    vueltaTotal = 0,&#10;                    recambio = 0&#10;                )&#10;            )&#10;        }&#10;        adapter = EntradaAdapter(products)&#10;        recyclerView.adapter = adapter&#10;        adapter?.submitList(entradaItems.toList())&#10;    }&#10;&#10;    private fun showConfirmDialog() {&#10;        if (!NetworkUtils.isConnectedToWifi(requireContext())) {&#10;            showWifiWarning()&#10;            return&#10;        }&#10;&#10;        if (!entradaItems.any { it.vueltaLleno &gt; 0 || it.vueltaTotal &gt; 0 || it.recambio &gt; 0 }) {&#10;            Toast.makeText(requireContext(), &quot;Ingrese algún valor antes de guardar&quot;, Toast.LENGTH_SHORT).show()&#10;            return&#10;        }&#10;&#10;        MaterialAlertDialogBuilder(requireContext())&#10;            .setTitle(&quot;Confirmar Entrada&quot;)&#10;            .setMessage(&quot;¿Guardar entrada del reparto $numeroReparto?&quot;)&#10;            .setPositiveButton(&quot;Sí, Guardar&quot;) { _, _ -&gt; guardarEntrada() }&#10;            .setNegativeButton(&quot;Cancelar&quot;, null)&#10;            .show()&#10;    }&#10;&#10;    private fun showWifiWarning() {&#10;        MaterialAlertDialogBuilder(requireContext())&#10;            .setTitle(&quot;⚠️ Sin WiFi&quot;)&#10;            .setMessage(&quot;Conéctese a la red WiFi de la empresa para enviar datos. ¿Abrir configuración WiFi?&quot;)&#10;            .setIcon(android.R.drawable.ic_dialog_alert)&#10;            .setPositiveButton(&quot;Abrir WiFi&quot;) { _, _ -&gt;&#10;                try {&#10;                    val intent = Intent(Settings.ACTION_WIFI_SETTINGS)&#10;                    startActivity(intent)&#10;                } catch (e: Exception) {&#10;                    Toast.makeText(context, &quot;No se pudo abrir WiFi&quot;, Toast.LENGTH_SHORT).show()&#10;                }&#10;            }&#10;            .setNegativeButton(&quot;Cancelar&quot;, null)&#10;            .show()&#10;    }&#10;&#10;    private fun guardarEntrada() {&#10;        // Placeholder: Aquí iría el POST real para entrada&#10;        progressBar.visibility = View.VISIBLE&#10;        btnGuardarEntrada.isEnabled = false&#10;&#10;        // Simulación rápida&#10;        lifecycleScope.launch {&#10;            // Podría construir request similar a OutRequest si hace falta otro modelo&#10;            progressBar.visibility = View.GONE&#10;            btnGuardarEntrada.isEnabled = true&#10;            MaterialAlertDialogBuilder(requireContext())&#10;                .setTitle(&quot;Éxito&quot;)&#10;                .setMessage(&quot;Entrada guardada para reparto $numeroReparto&quot;)&#10;                .setPositiveButton(&quot;OK&quot;) { _, _ -&gt;&#10;                    requireActivity().onBackPressedDispatcher.onBackPressed()&#10;                }&#10;                .show()&#10;        }&#10;    }&#10;}&#10;" />
            </PendingDiffInfo>
          </value>
        </entry>
        <entry key="$PROJECT_DIR$/app/src/main/java/com/lavazza/ciclocafe/utils/Constants.kt">
          <value>
            <PendingDiffInfo>
              <option name="filePath" value="$PROJECT_DIR$/app/src/main/java/com/lavazza/ciclocafe/utils/Constants.kt" />
              <option name="originalContent" value="package com.lavazza.ciclocafe.utils&#10;&#10;/**&#10; * Application constants&#10; */&#10;object Constants {&#10;&#10;    /** Repartos available for Entrada/Salida selection */&#10;    object Repartos {&#10;        const val REPARTO_502 = &quot;502&quot;&#10;        const val REPARTO_503 = &quot;503&quot;&#10;        const val REPARTO_505 = &quot;505&quot;&#10;&#10;        val REPARTOS_DISPONIBLES = listOf(REPARTO_502, REPARTO_503)&#10;&#10;        fun esRepartoValido(numeroReparto: String): Boolean =&#10;            numeroReparto in REPARTOS_DISPONIBLES&#10;    }&#10;&#10;    /** Generic login credentials (in-memory) */&#10;    object Auth {&#10;        const val USERNAME = &quot;Cafe&quot;&#10;        const val PASSWORD = &quot;Cafe123&quot;&#10;    }&#10;}&#10;" />
              <option name="updatedContent" value="package com.lavazza.ciclocafe.utils&#10;&#10;/**&#10; * Application constants&#10; */&#10;object Constants {&#10;&#10;    /** Repartos available for Entrada/Salida selection */&#10;    object Repartos {&#10;        const val REPARTO_502 = &quot;502&quot;&#10;        const val REPARTO_503 = &quot;503&quot;&#10;        const val REPARTO_505 = &quot;505&quot;&#10;&#10;        // Agregamos 505 a la lista de válidos&#10;        val REPARTOS_DISPONIBLES = listOf(REPARTO_502, REPARTO_503, REPARTO_505)&#10;&#10;        fun esRepartoValido(numeroReparto: String): Boolean =&#10;            numeroReparto in REPARTOS_DISPONIBLES&#10;    }&#10;&#10;    /** Generic login credentials (in-memory) */&#10;    object Auth {&#10;        const val USERNAME = &quot;Cafe&quot;&#10;        const val PASSWORD = &quot;Cafe123&quot;&#10;    }&#10;}" />
            </PendingDiffInfo>
          </value>
        </entry>
        <entry key="$PROJECT_DIR$/build_apk.bat">
          <value>
            <PendingDiffInfo>
              <option name="filePath" value="$PROJECT_DIR$/build_apk.bat" />
              <option name="updatedContent" value="@echo off&#10;echo =========================================&#10;echo  Construyendo APK de CicloCafe&#10;echo =========================================&#10;echo.&#10;&#10;cd /d &quot;%~dp0&quot;&#10;&#10;echo Limpiando proyecto...&#10;call gradlew.bat clean&#10;&#10;echo.&#10;echo Construyendo APK de debug...&#10;call gradlew.bat assembleDebug&#10;&#10;echo.&#10;echo =========================================&#10;if exist &quot;app\build\outputs\apk\debug\app-debug.apk&quot; (&#10;    echo APK generada exitosamente!&#10;    echo Ubicacion: app\build\outputs\apk\debug\app-debug.apk&#10;    echo.&#10;    echo Abriendo carpeta...&#10;    explorer &quot;app\build\outputs\apk\debug&quot;&#10;) else (&#10;    echo ERROR: No se pudo generar la APK&#10;    echo Revisa los errores anteriores&#10;)&#10;echo =========================================&#10;echo.&#10;pause&#10;" />
            </PendingDiffInfo>
          </value>
        </entry>
        <entry key="$PROJECT_DIR$/generar_keystore.bat">
          <value>
            <PendingDiffInfo>
              <option name="filePath" value="$PROJECT_DIR$/generar_keystore.bat" />
              <option name="updatedContent" value="@echo off&#10;echo Generando keystore de debug...&#10;cd /d &quot;%~dp0&quot;&#10;&#10;:: Verificar si ya existe el keystore&#10;if exist &quot;app\debug.keystore&quot; (&#10;    echo El keystore de debug ya existe. Eliminando...&#10;    del &quot;app\debug.keystore&quot;&#10;)&#10;&#10;:: Generar el keystore de debug&#10;keytool -genkey -v -keystore app\debug.keystore -storepass android -alias androiddebugkey -keypass android -keyalg RSA -keysize 2048 -validity 10000 -dname &quot;CN=Android Debug,O=Android,C=US&quot;&#10;&#10;if exist &quot;app\debug.keystore&quot; (&#10;    echo.&#10;    echo Keystore generado exitosamente!&#10;    echo Ubicacion: app\debug.keystore&#10;) else (&#10;    echo.&#10;    echo ERROR: No se pudo generar el keystore&#10;    echo Asegurate de tener Java JDK instalado&#10;)&#10;&#10;pause&#10;" />
            </PendingDiffInfo>
          </value>
        </entry>
      </map>
    </option>
  </component>
</project>